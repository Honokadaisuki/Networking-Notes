# Chapter 12 多路访问

当一群东西共享介质的时候, 就需要点方法来控制这些东西说话.

控制多路访问的方法有三类:

1. 随机访问
   1. ALOHA
   2. CSMA
   3. CSMA/CD
   4. CSMA/CA(十四章)
2. 受控访问
   1. 预约
   2. 轮询
   3. 令牌
3. 通道化
   1. TDM
   2. FDM
   3. ...

## 随机访问

### ALOHA

#### 纯ALOHA协议

发, 发不出去就等 $$rand(0,2^k-1)*T$$ 再发, k++;(截断型二进制指数退让算法).

T可以是Tp或者Tfr.

可能冲突时间是$$ 2 \times T_{fr}$$

意思是在这一帧发之前的Tfr和开始发之后的Tfr内都有可能有人再发, 这时候发就会干扰这一帧.

吞吐量 $$S = Ge^{-2G}$$, $$G = \frac{1}{2}$$的时候取$$S_{max}$$

G是Tfr内系统产生帧的期望.

#### 时隙ALOHA协议

纯aloha协议太拉了, 就有时隙ALOHA协议, 时间被分成了离散的.

可能冲突时间少了一半, 只有Tfr

吞吐量  $$S = Ge^{-G}$$, $$G = 1$$的时候取$$S_{max}$$



### CSMA协议

CSMA全称是载波侦听多路访问, 意思就是在发之前他会探一下信道是否空闲.

CSMA常用有三种策略:

- 1-坚持型CSMA

  就是一直探, 能发就赶紧发, 不能发就一直探.

- p-坚持型CSMA

  一直探, 能发就以p的几率发, 否则就等一段固定的时间再探

- 非坚持型CSMA

  能发就发, 不能发就随机延迟(二进制啥玩意的方法延迟)

  

### CSMA/CD协议

带冲突检测的CSMA, 主要是CD部分.

还是一直探, 能发就发, 发的时候听, 如果发现自己发的和听的不一样, 就说明冲突了, 停下来, 随机延迟避让.

争用期/冲突窗口是$$ 2 \times \tau$$ , 意思是这段时间听不到错误不代表一定能不冲突地发出去. 但是过了这段时间, 就说明信道抢占成功, 一定能发出去了.

对于10M的以太网, 争用期规定为51.2us, 意思是只要把前512bits(64B)发送出去, 那以后就没人能干扰自己了. 

同时, 以太网的最小帧长也是这样来的, 64B.

要注意的是, 对于100M, 1000M的以太网, 最小帧长也是64B, 只不过把争用时间减少了, 同时最大的网线长度也减少了.

还有, 只有半双工的环境下需要CD, 全双工是不需要CD的.



##### 截断型二进制指数退让算法

先选个基本时间, 一般就是$$ 2\times \tau$$ .

然后k刚开始等于0, 碰撞一次就+1,

然后等待rand[0,M] * 基本时间, 其中

1. $$1 \leq N \leq 10, M = 2^{N}-1$$
2. $$10 \leq N \leq 15, M = 2^{10}-1 = 1023$$
3. $$N = 16, 直接扔了, 爬$$





## 受控访问

我感觉就考一个令牌.

### 令牌

就是网络是个圈, 有个特殊的帧在圈里转, 拿到了帧的才能发数据.



